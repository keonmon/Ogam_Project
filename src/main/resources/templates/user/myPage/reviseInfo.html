<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë§ˆì´í˜ì´ì§€</title>
    
    <link rel="stylesheet" type="text/css" href="css/reviseInfo.css?after" />
    <link rel="stylesheet" type="text/css" href="css/reset.css?after" />
    <link rel="stylesheet" type="text/css" href="css/test.css" />
    <script src="https://kit.fontawesome.com/f9358a6ceb.js" crossorigin="anonymous"></script>
</head>

<body>
    <div class="container">
        <aside th:replace="frag/user/user_sidebar :: userSidebar(currMenu='')" class="sidebar"></aside>
        <main class="bodyContainer">
            <div th:replace="~{frag/user/user_menubar :: userMenubar(${notifiSelectList}) }" class="menubar"></div>
            <div class="contents">

                 <!-- ë§ˆì´ í”„ë¡œí•„ ì‹œì‘ -->
                <div id="wrap">
                    <form action="/reviseUpdate" method="post" enctype="multipart/form-data" id="frm">
                       <div class="base">
                            <div id="top">
                                <span id="myTitle">ë§ˆì´í”„ë¡œí•„</span>
                            </div>
                            <div id="middle">
                                <div id="profile">
                                    <span>
                                        <div class="pTitle">í”„ë¡œí•„</div>
                                        <div class="pTitle">ì‚¬ì§„</div>
                                    </span>
                                    <div class="photo">
                                        <span id="imgBlock">
                                                <img th:src="${member['BGIMG_PATH'] == null ? 'img/basicProfile.png' : member['BGIMG_PATH']}" id="proImg"/>
                                        </span>
                                        <label for="member_image">
                                            <div id="photoPick">ì‚¬ì§„ ì„ íƒ</div>
                                        </label>
                                        <span class="proDel" style="margin-left:20px;">ì‚¬ì§„ ì‚­ì œ</span>
                                        <input type="file" style="display:none;" accept="image/*" id="member_image" name="file" th:value="${member['BGIMG_PATH']}" />
                                        <input type="hidden" id="deleteImg" name="deleteImg" value="">
                                    </div>
                                </div>
                                <div id="intro">
                                    <span class="iTitle">ì†Œê°œê¸€</span>
                                        <textarea name="member_intro">[[ ${member.MEMBER_INTRO} ]]</textarea>
                                </div>
                                <div id="email">
                                    <span class="eTitle">ì´ë©”ì¼</span>
                                    <span class="part1">
                                        <span><input type="text" name="id" class="emailBox" th:value="${member.MEMBER_EMAIL}" readonly/></span>
                                    </span>
                                </div>
                                <div class="password">
                                    <span class="pwTitle">
                                        <div>ë¹„ë°€ë²ˆí˜¸</div>
                                    </span>
                                    <input type="password" th:placeholder="${session['accessToken']} ? 'Kakao ë¡œê·¸ì¸' " th:disabled="${session['accessToken']} ? 'disabled'" id="member_pw" name="member_pw" th:value="${member['MEMBER_PW'] == null ? '' : member['member_pw']}" onchange="new_pw_chk()"/>
                                </div>
                                <div class="password">
                                    <span>
                                        <div class="pwTitle">ë¹„ë°€ë²ˆí˜¸</div>
                                        <div class="pwTitle">ì¬í™•ì¸</div>
                                    </span>
                                    <input type="password" th:placeholder="${session['accessToken']} ? 'Kakao ë¡œê·¸ì¸' " th:disabled="${session['accessToken']} ? 'disabled'" id="member_repw" onchange="chk_pwd()" />
                                    <input hidden id="kakaoLoginChk" th:value="${session['accessToken']}"/>
                                </div>
                                <div class="nickName">
                                    <div class="nTitle">ë‹‰ë„¤ì„</div>
                                    <input type="text" id="member_nick" name="member_nick" th:value="${member.MEMBER_NICK}"/>
                                    <input type="button" id="nick_chk" onclick="uniqueChk()" value="ì¤‘ë³µí™•ì¸">
                                </div>
                                <div class="birthday">
                                    <div class="bTitle">ìƒë…„ì›”ì¼</div>
                                    <input type="text" placeholder="YYYY" required pattern="19[0-9][0-9]|20\d{2}" id="member_birth1" name="member_birth1" th:value="${year}"/><span class="ymd">ë…„</span>
                                    <input type="text" placeholder="MM" required pattern="0[0-9]|1[0-2]" id="member_birth2" name="member_birth2" th:value="${month}"/><span class="ymd">ì›”</span>
                                    <input type="text" placeholder="DD" required pattern="0[1-9]|[1-2][0-9]|3[0-1]" id="member_birth3" name="member_birth3" th:value="${day}"/><span class="ymd">ì¼</span>
                                </div>
                                <div class="phone">
                                    <div class="phTitle">íœ´ëŒ€í°ë²ˆí˜¸</div>
                                    <input type="text" id="member_phone" name="member_phone" placeholder="ì „í™”ë²ˆí˜¸ ì…ë ¥" th:value="${member['MEMBER_PHONE'] == null ? '' : member['MEMBER_PHONE']}" readonly/>
                                </div>
                            </div>
                            <div class="btn_bottom">
                                <input type="button" id="finish" value="íšŒì›ì •ë³´ ìˆ˜ì •í•˜ê¸°" onclick="reviseInfoSubmit()">
                                <input type="hidden" name="member_email" th:value="${member.MEMBER_EMAIL}"/>
                            </div>
                           <div class="btn_delete">
                               <p><a href="#modal" rel="modal:open">íƒˆí‡´í•˜ê¸°</a></p>
                           </div>
                       </div>
                    </form>
                </div>
                <!-- ë§ˆì´ í”„ë¡œí•„ ë -->
                <!-- modal 1 -->
                <div id="modal" style="height:420px;" class="modalContainer">
                    <div class="wrapModal">
                        <span class="sideLine">
                          <div class="outLine"></div>
                          <div class="inLine"></div>
                        </span>
                        <div>
                            <span class="hTitle">íƒˆí‡´í•˜ê¸°</span>

                        </div>
                        <span class="deleteGuide">
                          <div>
                            íšŒì›íƒˆí‡´ë¥¼ ì‹ ì²­í•˜ê¸° ì „ì— <strong>ì•ˆë‚´ ì‚¬í•­</strong>ì„ ê¼­ í™•ì¸í•´
                            ì£¼ì„¸ìš”.
                          </div>
                          <div>
                            - íƒˆí‡´ ì‹œ, ë“±ë¡í•œ ê²Œì‹œë¬¼ì€
                            <strong style="color: red">ì „ì²´ ì‚­ì œ</strong>ë©ë‹ˆë‹¤.
                          </div>
                        </span>
                        <span class="line"></span>

                        <!-- form -->
                            <div class="deleteBox">
                                <span class="deleteTitle">ë¹„ë°€ë²ˆí˜¸</span>
                                <input type="password" class="passInput" id="member_pwd" />
                            </div>
                            <a type="button" class="nextBtn" href="#modal2" rel="modal:open" >ì§„ì§œ...? ğŸ˜¥</a>
                        <!-- form end -->
                    </div>
                </div>
                <!-- modal end -->
                <div id="modal2" style="height:420px;"  class="modal">
                    <!-- modal 2 -->
                        <div class="wrapModal">
                            <div class="sideLine">
                                <div class="outLine"></div>
                                <div class="inLine"></div>
                            </div>
                            <div>
                                <span class="hTitle">íƒˆí‡´í•˜ê¸°</span>
                            </div>
                            <span class="deleteGuide">
                              <div>
                                íšŒì›íƒˆí‡´ë¥¼ ì‹ ì²­í•˜ê¸° ì „ì— <strong>ì•ˆë‚´ ì‚¬í•­</strong>ì„ ê¼­ í™•ì¸í•´
                                ì£¼ì„¸ìš”.
                              </div>
                              <div>
                                - íƒˆí‡´ ì‹œ, ë“±ë¡í•œ ê²Œì‹œë¬¼ì€
                                <strong style="color: red">ì „ì²´ ì‚­ì œ</strong>ë©ë‹ˆë‹¤.
                              </div>
                            </span>
                            <div class="line"></div>

                            <!-- form -->
                            <form action="/delMember" method="post">
                                <div class="deleteBox">
                                    <div class="deleteTitle" name="member_quited_reason">ì™œ ë– ë‚˜..?</div>
                                    <textarea
                                            class="reasonInput"
                                            type="text"
                                            id="deleteInput"
                                            placeholder="ë– ë‚˜ëŠ” ì´ìœ ë¥¼ ì ì–´ ì£¼ì„¸ìš”... ğŸ˜¥"
                                    ></textarea>
                                </div>
                                <input type="hidden" name="member_pw" id="member_pass" value=""/>
                                <button type="submit" class="deleteBtn" >íƒˆí‡´í•˜ê¸° ğŸ˜¥</button>
                                <!-- <a href="../userDashboard.html" class="deleteBtn">íƒˆí‡´í•˜ê¸° ğŸ˜¥</a> -->
                            </form>
                            <!-- form end -->

                        </div>
                    </div>
                    <!-- modal2 end -->
                </div>
        </main>
    </div>
    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script>
<!--    ë‹‰ë„¤ì„ ì¤‘ë³µí™•ì¸-->
        function uniqueChk() {
            let member_nick = $('#member_nick').val();

            if(member_nick.length == 0){
                alert("ë‹‰ë„¤ì„ì´ ë„ˆë¬´ ì§§ìŠµë‹ˆë‹¤ğŸ˜«");
                return;
            }

            $.ajax({
                url: '/unique',
                data: {"member_nick":member_nick},
                type:'post',
                success: function(name) {
                    if (name == 1) {
                        alert("ì´ë¯¸ ì‚¬ìš© ì¤‘ì¸ ë‹‰ë„¤ì„ì…ë‹ˆë‹¤ğŸ™");
                        return;
                    } else if(name == 0) {
                        alert("ì‚¬ìš©ê°€ëŠ¥í•œ ë‹‰ë„¤ì„ì…ë‹ˆë‹¤â˜ºï¸");
                        $("input[name='nicky']").val('y');
                    }
                },
                error: function() {
                    alert(name);

                }
            })
        }

        //ì´ë¯¸ì§€ ì„ íƒí•˜ë©´ ë¯¸ë¦¬ë³´ê¸°
        $('#member_image').on("change", function(event) {
            var file = event.target.files[0];

            var reader = new FileReader();
            reader.onload = function(e) {
                $('#proImg').attr("src", e.target.result);
            }
            reader.readAsDataURL(file);
            $("#deleteImg").val("");
        })

        // ì‚¬ì§„ì‚­ì œë²„íŠ¼
        $('.proDel').on("click", function() {
            $('#proImg').attr("src", 'img/basicProfile.png');
            $("#deleteImg").val("Y");
        });

        //íƒˆí‡´í•  ë•Œ ë¹„ë°€ë²ˆí˜¸ í™•ì¸
       $('#member_pwd').on("change", function() {
            var pw = $('#member_pwd').val();
            $("#member_pass").val(pw);
       })


    </script>
    <link rel="stylesheet" type="text/css" href="css/deleteUser.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css" />
    <script src="js/reviseInfo.js" type="text/javascript"></script>
</body>

</html>